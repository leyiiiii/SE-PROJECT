{"version":3,"file":"js/338.a8336033.js","mappings":"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","sources":["webpack://se-project/./src/custom-component/VText/Component.vue","webpack://se-project/src/custom-component/VText/Component.vue","webpack://se-project/./src/custom-component/VText/Component.vue?01b0","webpack://se-project/./src/custom-component/VText/Component.vue?da7c","webpack://se-project/./src/custom-component/common/OnEvent.vue","webpack://se-project/src/custom-component/common/OnEvent.vue","webpack://se-project/./src/custom-component/common/OnEvent.vue?d8a8","webpack://se-project/./src/utils/request.js","webpack://se-project/./src/utils/shortcutKey.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.editMode == 'edit')?_c('div',{staticClass:\"v-text\",on:{\"keydown\":_vm.handleKeydown,\"keyup\":_vm.handleKeyup}},[_c('div',{ref:\"text\",class:{ canEdit: _vm.canEdit },style:({ verticalAlign: _vm.element.style.verticalAlign }),attrs:{\"contenteditable\":_vm.canEdit,\"tabindex\":_vm.element.id},domProps:{\"innerHTML\":_vm._s(_vm.element.propValue)},on:{\"dblclick\":_vm.setEdit,\"paste\":_vm.clearStyle,\"mousedown\":_vm.handleMousedown,\"blur\":_vm.handleBlur,\"input\":_vm.handleInput}})]):_c('div',{staticClass:\"v-text preview\"},[_c('div',{style:({ verticalAlign: _vm.element.style.verticalAlign }),domProps:{\"innerHTML\":_vm._s(_vm.element.propValue)}})])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!-- eslint-disable vue/no-v-html -->\r\n<template>\r\n    <div\r\n        v-if=\"editMode == 'edit'\"\r\n        class=\"v-text\"\r\n        @keydown=\"handleKeydown\"\r\n        @keyup=\"handleKeyup\"\r\n    >\r\n        <!-- tabindex >= 0 使得双击时聚焦该元素 -->\r\n        <div\r\n            ref=\"text\"\r\n            :contenteditable=\"canEdit\"\r\n            :class=\"{ canEdit }\"\r\n            :tabindex=\"element.id\"\r\n            :style=\"{ verticalAlign: element.style.verticalAlign }\"\r\n            @dblclick=\"setEdit\"\r\n            @paste=\"clearStyle\"\r\n            @mousedown=\"handleMousedown\"\r\n            @blur=\"handleBlur\"\r\n            @input=\"handleInput\"\r\n            v-html=\"element.propValue\"\r\n        ></div>\r\n    </div>\r\n    <div v-else class=\"v-text preview\">\r\n        <div :style=\"{ verticalAlign: element.style.verticalAlign }\" v-html=\"element.propValue\"></div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport { keycodes } from '@/utils/shortcutKey.js'\r\nimport request from '@/utils/request'\r\nimport OnEvent from '../common/OnEvent'\r\n\r\nexport default {\r\n    extends: OnEvent,\r\n    props: {\r\n        propValue: {\r\n            type: String,\r\n            required: true,\r\n            default: '',\r\n        },\r\n        request: {\r\n            type: Object,\r\n            default: () => {},\r\n        },\r\n        element: {\r\n            type: Object,\r\n            default: () => {},\r\n        },\r\n        linkage: {\r\n            type: Object,\r\n            default: () => {},\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n            canEdit: false,\r\n            ctrlKey: 17,\r\n            isCtrlDown: false,\r\n            cancelRequest: null,\r\n        }\r\n    },\r\n    computed: {\r\n        ...mapState([\r\n            'editMode',\r\n        ]),\r\n    },\r\n    created() {\r\n        // 注意，修改时接口属性时不会发数据，在预览时才会发\r\n        // 如果要在修改接口属性的同时发请求，需要 watch 一下 request 的属性\r\n        if (this.request) {\r\n            // 第二个参数是要修改数据的父对象，第三个参数是修改数据的 key，第四个数据修改数据的类型\r\n            this.cancelRequest = request(this.request, this.element, 'propValue', 'string')\r\n        }\r\n    },\r\n    beforeDestroy() {\r\n        // 组件销毁时取消请求\r\n        this.request && this.cancelRequest()\r\n    },\r\n    methods: {\r\n        handleInput(e) {\r\n            this.$emit('input', this.element, e.target.innerHTML)\r\n        },\r\n\r\n        handleKeydown(e) {\r\n            // 阻止冒泡，防止触发复制、粘贴组件操作\r\n            this.canEdit && e.stopPropagation()\r\n            if (e.keyCode == this.ctrlKey) {\r\n                this.isCtrlDown = true\r\n            } else if (this.isCtrlDown && this.canEdit && keycodes.includes(e.keyCode)) {\r\n                e.stopPropagation()\r\n            } else if (e.keyCode == 46) { // deleteKey\r\n                e.stopPropagation()\r\n            }\r\n        },\r\n\r\n        handleKeyup(e) {\r\n            // 阻止冒泡，防止触发复制、粘贴组件操作\r\n            this.canEdit && e.stopPropagation()\r\n            if (e.keyCode == this.ctrlKey) {\r\n                this.isCtrlDown = false\r\n            }\r\n        },\r\n\r\n        handleMousedown(e) {\r\n            if (this.canEdit) {\r\n                e.stopPropagation()\r\n            }\r\n        },\r\n\r\n        clearStyle(e) {\r\n            e.preventDefault()\r\n            const clp = e.clipboardData\r\n            const text = clp.getData('text/plain') || ''\r\n            if (text !== '') {\r\n                document.execCommand('insertText', false, text)\r\n            }\r\n\r\n            this.$emit('input', this.element, e.target.innerHTML)\r\n        },\r\n\r\n        handleBlur(e) {\r\n            this.element.propValue = e.target.innerHTML || '&nbsp;'\r\n            const html = e.target.innerHTML\r\n            if (html !== '') {\r\n                this.element.propValue = e.target.innerHTML\r\n            } else {\r\n                this.element.propValue = ''\r\n                this.$nextTick(() => {\r\n                    this.element.propValue = '&nbsp;'\r\n                })\r\n            }\r\n            this.canEdit = false\r\n        },\r\n\r\n        setEdit() {\r\n            if (this.element.isLock) return\r\n\r\n            this.canEdit = true\r\n            // 全选\r\n            this.selectText(this.$refs.text)\r\n        },\r\n\r\n        selectText(element) {\r\n            const selection = window.getSelection()\r\n            const range = document.createRange()\r\n            range.selectNodeContents(element)\r\n            selection.removeAllRanges()\r\n            selection.addRange(range)\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.v-text {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: table;\r\n\r\n    div {\r\n        display: table-cell;\r\n        width: 100%;\r\n        height: 100%;\r\n        outline: none;\r\n        word-break: break-all;\r\n        padding: 4px;\r\n    }\r\n\r\n    .canEdit {\r\n        cursor: text;\r\n        height: 100%;\r\n    }\r\n}\r\n\r\n.preview {\r\n    user-select: none;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Component.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Component.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Component.vue?vue&type=template&id=299b909a&scoped=true&\"\nimport script from \"./Component.vue?vue&type=script&lang=js&\"\nexport * from \"./Component.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Component.vue?vue&type=style&index=0&id=299b909a&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"299b909a\",\n  null\n  \n)\n\nexport default component.exports","var render, staticRenderFns\nimport script from \"./OnEvent.vue?vue&type=script&lang=js&\"\nexport * from \"./OnEvent.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<script>\r\nimport eventBus from '@/utils/eventBus'\r\n\r\nexport default {\r\n    props: {\r\n        linkage: {\r\n            type: Object,\r\n            default: () => {},\r\n        },\r\n        element: {\r\n            type: Object,\r\n            default: () => {},\r\n        },\r\n    },\r\n    created() {\r\n        if (this.linkage?.data?.length) {\r\n            eventBus.$on('v-click', this.onClick)\r\n            eventBus.$on('v-hover', this.onHover)\r\n        }\r\n    },\r\n    mounted() {\r\n        const { data, duration } = this.linkage || {}\r\n        if (data?.length) {\r\n            this.$el.style.transition = `all ${duration}s`\r\n        }\r\n    },\r\n    beforeDestroy() {\r\n        if (this.linkage?.data?.length) {\r\n            eventBus.$off('v-click', this.onClick)\r\n            eventBus.$off('v-hover', this.onHover)\r\n        }\r\n    },\r\n    methods: {\r\n        changeStyle(data = []) {\r\n            data.forEach(item => {\r\n                item.style.forEach(e => {\r\n                    if (e.key) {\r\n                        this.element.style[e.key] = e.value\r\n                    }\r\n                })\r\n            })\r\n        },\r\n\r\n        onClick(componentId) {\r\n            const data = this.linkage.data.filter(item => item.id === componentId && item.event === 'v-click')\r\n            this.changeStyle(data)\r\n        },\r\n\r\n        onHover(componentId) {\r\n            const data = this.linkage.data.filter(item => item.id === componentId && item.event === 'v-hover')\r\n            this.changeStyle(data)\r\n        },\r\n    },\r\n}\r\n</script>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OnEvent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OnEvent.vue?vue&type=script&lang=js&\"","import { Message } from 'element-ui'\r\n\r\nexport const urlRE = /(https?):\\/\\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/\r\n\r\nfunction request(options) {\r\n    return new Promise((resolve, reject) => {\r\n        const xhr = new XMLHttpRequest()\r\n        xhr.timeout = 6000\r\n\r\n        let url = getURL(options.url)\r\n        if (options.method === 'GET') {\r\n            url += `${getURLParam(options.data)}`\r\n        }\r\n\r\n        xhr.open(options.method, url)\r\n\r\n        xhr.ontimeout = reject\r\n        xhr.onerror = reject\r\n        xhr.onload = (e) => {\r\n            resolve(e.target.response)\r\n        }\r\n\r\n        xhr.send(JSON.stringify(getURLData(options.data, options.paramType)))\r\n    })\r\n}\r\n\r\nfunction getURLParam(data) {\r\n    let result = ''\r\n    data.forEach(item => {\r\n        if (item[0]) {\r\n            result += `&${item[0]}=${item[1]}`\r\n        }\r\n    })\r\n\r\n    return result ? '?' + result : ''\r\n}\r\n\r\nfunction getURLData(data, paramType) {\r\n    if (!data) return ''\r\n\r\n    if (paramType === 'array') {\r\n        return data\r\n    }\r\n\r\n    const result = {}\r\n    data.forEach(item => {\r\n        if (item[0]) {\r\n            result[item[0]] = item[1]\r\n        }\r\n    })\r\n\r\n    return result\r\n}\r\n\r\nexport function getURL(url) {\r\n    return url.startsWith('http') ? url : 'https://' + url\r\n}\r\n\r\n/**\r\n *\r\n * @param {object} options 请求的相关参数\r\n * @param {object} obj 需要修改的数据的父对象\r\n * @param {string} key 需要修改的数据在父对象中对应的 key\r\n * @param {string} responseType 需要修改的数据对应的类型\r\n * @returns\r\n */\r\nexport default function requestWarpper(options, obj, key, responseType = 'object') {\r\n    let count = 0\r\n    let timer\r\n    const url = options?.url\r\n    if (url && !/^\\d+$/.test(url) || urlRE.test(getURL(url))) {\r\n        if (!options.series) {\r\n            request(options, responseType)\r\n            .then(data => {\r\n                if (responseType === 'object' || responseType === 'array') {\r\n                    obj[key] = JSON.parse(data)\r\n                } else {\r\n                    obj[key] = data\r\n                }\r\n            })\r\n            .catch(err => Message.error(err?.message || err))\r\n        } else {\r\n            timer = setInterval(() => {\r\n                if (options.requestCount != 0 && options.requestCount <= count) {\r\n                    clearInterval(timer)\r\n                    return\r\n                }\r\n\r\n                count++\r\n                request(options, responseType)\r\n                .then(data => {\r\n                    if (responseType === 'object' || responseType === 'array') {\r\n                        obj[key] = JSON.parse(data)\r\n                    } else {\r\n                        obj[key] = data\r\n                    }\r\n                })\r\n                .catch(err => Message.error(err?.message || err))\r\n            }, options.time)\r\n        }\r\n    }\r\n\r\n    return function cancelRequest() {\r\n        clearInterval(timer)\r\n    }\r\n}\r\n","import store from '@/store'\r\nimport eventBus from '@/utils/eventBus'\r\n\r\nconst ctrlKey = 17,\r\n    commandKey = 91, // mac command\r\n    vKey = 86, // 粘贴\r\n    cKey = 67, // 复制\r\n    xKey = 88, // 剪切\r\n\r\n    yKey = 89, // 重做\r\n    zKey = 90, // 撤销\r\n\r\n    gKey = 71, // 组合\r\n    bKey = 66, // 拆分\r\n\r\n    lKey = 76, // 锁定\r\n    uKey = 85, // 解锁\r\n\r\n    sKey = 83, // 保存\r\n    pKey = 80, // 预览\r\n    dKey = 68, // 删除\r\n    deleteKey = 46, // 删除\r\n    eKey = 69 // 清空画布\r\n\r\nexport const keycodes = [66, 67, 68, 69, 71, 76, 80, 83, 85, 86, 88, 89, 90]\r\n\r\n// 与组件状态无关的操作\r\nconst basemap = {\r\n    [vKey]: paste,\r\n    [yKey]: redo,\r\n    [zKey]: undo,\r\n    [sKey]: save,\r\n    [pKey]: preview,\r\n    [eKey]: clearCanvas,\r\n}\r\n\r\n// 组件锁定状态下可以执行的操作\r\nconst lockMap = {\r\n    ...basemap,\r\n    [uKey]: unlock,\r\n}\r\n\r\n// 组件未锁定状态下可以执行的操作\r\nconst unlockMap = {\r\n    ...basemap,\r\n    [cKey]: copy,\r\n    [xKey]: cut,\r\n    [gKey]: compose,\r\n    [bKey]: decompose,\r\n    [dKey]: deleteComponent,\r\n    [deleteKey]: deleteComponent,\r\n    [lKey]: lock,\r\n}\r\n\r\nlet isCtrlOrCommandDown = false\r\n// 全局监听按键操作并执行相应命令\r\nexport function listenGlobalKeyDown() {\r\n    window.onkeydown = (e) => {\r\n        if (!store.state.isInEdiotr) return\r\n\r\n        const { curComponent } = store.state\r\n        const { keyCode } = e\r\n        if (keyCode === ctrlKey || keyCode === commandKey) {\r\n            isCtrlOrCommandDown = true\r\n        } else if (keyCode == deleteKey && curComponent) {\r\n            store.commit('deleteComponent')\r\n            store.commit('recordSnapshot')\r\n        } else if (isCtrlOrCommandDown) {\r\n            if (unlockMap[keyCode] && (!curComponent || !curComponent.isLock)) {\r\n                e.preventDefault()\r\n                unlockMap[keyCode]()\r\n            } else if (lockMap[keyCode] && curComponent && curComponent.isLock) {\r\n                e.preventDefault()\r\n                lockMap[keyCode]()\r\n            }\r\n        }\r\n    }\r\n\r\n    window.onkeyup = (e) => {\r\n        if (e.keyCode === ctrlKey || e.keyCode === commandKey) {\r\n            isCtrlOrCommandDown = false\r\n        }\r\n    }\r\n\r\n    window.onmousedown = () => {\r\n        store.commit('setInEditorStatus', false)\r\n    }\r\n}\r\n\r\nfunction copy() {\r\n    store.commit('copy')\r\n}\r\n\r\nfunction paste() {\r\n    store.commit('paste')\r\n    store.commit('recordSnapshot')\r\n}\r\n\r\nfunction cut() {\r\n    store.commit('cut')\r\n}\r\n\r\nfunction redo() {\r\n    store.commit('redo')\r\n}\r\n\r\nfunction undo() {\r\n    store.commit('undo')\r\n}\r\n\r\nfunction compose() {\r\n    if (store.state.areaData.components.length) {\r\n        store.commit('compose')\r\n        store.commit('recordSnapshot')\r\n    }\r\n}\r\n\r\nfunction decompose() {\r\n    const curComponent = store.state.curComponent\r\n    if (curComponent && !curComponent.isLock && curComponent.component == 'Group') {\r\n        store.commit('decompose')\r\n        store.commit('recordSnapshot')\r\n    }\r\n}\r\n\r\nfunction save() {\r\n    eventBus.$emit('save')\r\n}\r\n\r\nfunction preview() {\r\n    eventBus.$emit('preview')\r\n}\r\n\r\nfunction deleteComponent() {\r\n    if (store.state.curComponent) {\r\n        store.commit('deleteComponent')\r\n        store.commit('recordSnapshot')\r\n    }\r\n}\r\n\r\nfunction clearCanvas() {\r\n    eventBus.$emit('clearCanvas')\r\n}\r\n\r\nfunction lock() {\r\n    store.commit('lock')\r\n}\r\n\r\nfunction unlock() {\r\n    store.commit('unlock')\r\n}\r\n"],"names":["render","_vm","this","_c","_self","editMode","staticClass","on","handleKeydown","handleKeyup","ref","class","canEdit","style","verticalAlign","element","attrs","id","domProps","_s","propValue","setEdit","clearStyle","handleMousedown","handleBlur","handleInput","staticRenderFns","extends","props","type","required","default","request","linkage","data","ctrlKey","isCtrlDown","cancelRequest","computed","created","beforeDestroy","methods","e","document","selectText","range","selection","component","eventBus","mounted","duration","changeStyle","item","onClick","onHover","urlRE","options","Promise","resolve","reject","xhr","XMLHttpRequest","timeout","url","getURL","method","getURLParam","open","ontimeout","onerror","onload","target","response","send","JSON","stringify","getURLData","paramType","result","forEach","startsWith","requestWarpper","obj","key","responseType","timer","count","test","series","setInterval","requestCount","clearInterval","then","parse","catch","err","Message","message","time","commandKey","vKey","cKey","xKey","yKey","zKey","gKey","bKey","lKey","uKey","sKey","pKey","dKey","deleteKey","eKey","keycodes","basemap","paste","redo","undo","save","preview","clearCanvas","lockMap","unlock","unlockMap","copy","cut","compose","decompose","deleteComponent","lock","isCtrlOrCommandDown","listenGlobalKeyDown","window","onkeydown","store","curComponent","keyCode","isLock","preventDefault","onkeyup","onmousedown"],"sourceRoot":""}