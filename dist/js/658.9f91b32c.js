"use strict";(self["webpackChunkse_project"]=self["webpackChunkse_project"]||[]).push([[658],{3013:function(t,e,a){a.r(e),a.d(e,{default:function(){return k}});var o=function(){var t=this,e=t._self._c;return e("el-row",[e("el-col",{attrs:{span:3}},[e("div",{staticClass:"design-content"},[e("div",{staticClass:"project-name"},[t._v(t._s(t.projectName))]),e("div",{staticClass:"content-title"},[e("i",{staticClass:"el-icon-s-unfold"}),t._v(" 设计原型 "),e("div",{staticClass:"add-icon",on:{click:t.add}},[t._v("+")])]),t._l(t.designList,(function(a){return e("li",{key:a.id,on:{click:function(e){return t.openFile(a.id)}}},[e("i",{staticClass:"el-icon-document"}),t._v(" "+t._s(a.title)+" ")])}))],2)]),e("el-col",{attrs:{span:21}},[t.isOpenAFile?e("div",{staticClass:"design"},[e("main",[e("Toolbar"),e("section",{staticClass:"left"},[e("ComponentList"),e("RealTimeComponentList")],1),e("section",{staticClass:"center"},[e("div",{staticClass:"content",on:{drop:t.handleDrop,dragover:t.handleDragOver,mousedown:t.handleMouseDown,mouseup:t.deselectCurComponent}},[e("Editor")],1)]),e("section",{staticClass:"right"},[t.curComponent?e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"属性",name:"attr"}},[e(t.curComponent.component+"Attr",{tag:"component"})],1),e("el-tab-pane",{staticStyle:{"padding-top":"20px"},attrs:{label:"动画",name:"animation"}},[e("AnimationList")],1),e("el-tab-pane",{staticStyle:{"padding-top":"20px"},attrs:{label:"事件",name:"events"}},[e("EventList")],1)],1):e("CanvasAttr")],1)],1)]):t._e()])],1)},n=[],s=a(694),i=a(5205),l=a(5912),r=a(9054),c=a(6845),d=a(6842),p=a(2648),m=a(629),g=a(1840),h=a(9657),u=a(9921),v=a(9571),C=a(4112),D={components:{NavigationBar:C.Z,Editor:s.Z,ComponentList:i.Z,AnimationList:l.Z,EventList:r.Z,Toolbar:d.Z,RealTimeComponentList:u.Z,CanvasAttr:v.Z},data(){return{activeName:"attr",reSelectAnimateIndex:void 0,isOpenAFile:!0,designId:"",designList:[]}},computed:(0,m.rn)(["componentData","curComponent","isClickComponent","canvasStyleData","editor"]),created(){var t=this.$route.params.id.split("&");this.projectId=t[0],this.getDesign(),t.length>2?(this.isOpenAFile=!0,this.designId=t[2],this.getDesignDetail()):this.isOpenAFile=!1,this.restore(),(0,h.Y)()},methods:{openFile(t){this.$router.replace("/project/"+this.projectId+"&design&"+t),window.location.reload()},add(){let t=new FormData;t.append("title","Unknown Document"),t.append("description","文档描述"),t.append("content",JSON.stringify("<p>this is a document</p>")),t.append("projectId",this.projectId);var e={};localStorage.getItem("token")&&(e={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"post",url:"/api/v1/document/create/"+this.projectId,data:t,headers:e}).then((t=>{console.log(t.data),this.openDoc(t.data.id)})).catch((t=>{console.log(t)}))},restore(){localStorage.getItem("canvasData")&&this.$store.commit("setComponentData",JSON.parse(localStorage.getItem("canvasData"))),localStorage.getItem("canvasStyle")&&this.$store.commit("setCanvasStyle",JSON.parse(localStorage.getItem("canvasStyle")))},handleDrop(t){t.preventDefault(),t.stopPropagation();const e=t.dataTransfer.getData("index"),a=this.editor.getBoundingClientRect();if(e){const o=(0,p.p$)(c.ZP[e]);o.style.top=t.clientY-a.y,o.style.left=t.clientX-a.x,o.id=(0,g.Z)(),this.$store.commit("addComponent",{component:o}),this.$store.commit("recordSnapshot")}},handleDragOver(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"},handleMouseDown(t){t.stopPropagation(),this.$store.commit("setClickComponentStatus",!1),this.$store.commit("setInEditorStatus",!0)},deselectCurComponent(t){this.isClickComponent||this.$store.commit("setCurComponent",{component:null,index:null}),2!=t.button&&this.$store.commit("hideContextMenu")},async getDesignDetail(){var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),await this.$axios({method:"get",url:"/api/v1/diagram/"+this.designId,headers:t}).then((t=>{console.log(t.data);t.data})).catch((t=>{console.log(t)}))},getDesign(){var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"get",url:"/api/v1/diagram/list?belongTo="+this.projectId,headers:t}).then((t=>{this.designList=t.data.results})).catch((t=>{console.log(t)}))}}},S=D,f=a(3736),I=(0,f.Z)(S,o,n,!1,null,null,null),k=I.exports}}]);
//# sourceMappingURL=658.9f91b32c.js.map