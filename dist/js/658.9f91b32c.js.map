{"version":3,"file":"js/658.9f91b32c.js","mappings":"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","sources":["webpack://se-project/./src/views/Design.vue","webpack://se-project/src/views/Design.vue","webpack://se-project/./src/views/Design.vue?ed67","webpack://se-project/./src/views/Design.vue?4a32"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-row',[_c('el-col',{attrs:{\"span\":3}},[_c('div',{staticClass:\"design-content\"},[_c('div',{staticClass:\"project-name\"},[_vm._v(_vm._s(_vm.projectName))]),_c('div',{staticClass:\"content-title\"},[_c('i',{staticClass:\"el-icon-s-unfold\"}),_vm._v(\" 设计原型 \"),_c('div',{staticClass:\"add-icon\",on:{\"click\":_vm.add}},[_vm._v(\"+\")])]),_vm._l((_vm.designList),function(item){return _c('li',{key:item.id,on:{\"click\":function($event){return _vm.openFile(item.id)}}},[_c('i',{staticClass:\"el-icon-document\"}),_vm._v(\" \"+_vm._s(item.title)+\" \")])})],2)]),_c('el-col',{attrs:{\"span\":21}},[(_vm.isOpenAFile)?_c('div',{staticClass:\"design\"},[_c('main',[_c('Toolbar'),_c('section',{staticClass:\"left\"},[_c('ComponentList'),_c('RealTimeComponentList')],1),_c('section',{staticClass:\"center\"},[_c('div',{staticClass:\"content\",on:{\"drop\":_vm.handleDrop,\"dragover\":_vm.handleDragOver,\"mousedown\":_vm.handleMouseDown,\"mouseup\":_vm.deselectCurComponent}},[_c('Editor')],1)]),_c('section',{staticClass:\"right\"},[(_vm.curComponent)?_c('el-tabs',{model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"属性\",\"name\":\"attr\"}},[_c(_vm.curComponent.component + 'Attr',{tag:\"component\"})],1),_c('el-tab-pane',{staticStyle:{\"padding-top\":\"20px\"},attrs:{\"label\":\"动画\",\"name\":\"animation\"}},[_c('AnimationList')],1),_c('el-tab-pane',{staticStyle:{\"padding-top\":\"20px\"},attrs:{\"label\":\"事件\",\"name\":\"events\"}},[_c('EventList')],1)],1):_c('CanvasAttr')],1)],1)]):_vm._e()])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<el-row>\r\n  <el-col :span=\"3\">\r\n    <div class=\"design-content\">\r\n      <div class=\"project-name\">{{ projectName }}</div>\r\n      <div class=\"content-title\">\r\n        <i class=\"el-icon-s-unfold\"></i>\r\n        设计原型\r\n        <div class=\"add-icon\" @click=\"add\">+</div>\r\n      </div>\r\n      <li v-for=\"item in designList\" :key=\"item.id\" @click=\"openFile(item.id)\">\r\n        <i class=\"el-icon-document\"></i>\r\n        {{ item.title }}\r\n      </li>\r\n    </div></el-col\r\n  >\r\n  <el-col :span=\"21\">\r\n    <div v-if=\"isOpenAFile\" class=\"design\">\r\n      <main>\r\n        <Toolbar />\r\n        <!-- 左侧组件列表 -->\r\n\r\n        <section class=\"left\">\r\n          <ComponentList />\r\n          <RealTimeComponentList />\r\n        </section>\r\n        <!-- 中间画布 -->\r\n        <section class=\"center\">\r\n          <div\r\n            class=\"content\"\r\n            @drop=\"handleDrop\"\r\n            @dragover=\"handleDragOver\"\r\n            @mousedown=\"handleMouseDown\"\r\n            @mouseup=\"deselectCurComponent\"\r\n          >\r\n            <Editor />\r\n          </div>\r\n        </section>\r\n        <!-- 右侧属性列表 -->\r\n        <section class=\"right\">\r\n          <el-tabs v-if=\"curComponent\" v-model=\"activeName\">\r\n            <el-tab-pane label=\"属性\" name=\"attr\">\r\n              <component :is=\"curComponent.component + 'Attr'\" />\r\n            </el-tab-pane>\r\n            <el-tab-pane\r\n              label=\"动画\"\r\n              name=\"animation\"\r\n              style=\"padding-top: 20px\"\r\n            >\r\n              <AnimationList />\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"事件\" name=\"events\" style=\"padding-top: 20px\">\r\n              <EventList />\r\n            </el-tab-pane>\r\n          </el-tabs>\r\n          <CanvasAttr v-else></CanvasAttr>\r\n        </section>\r\n      </main>\r\n    </div>\r\n  </el-col></el-row>\r\n</template>\r\n\r\n<script>\r\nimport Editor from \"@/components/Editor/index\";\r\nimport ComponentList from \"@/components/ComponentList\"; // 左侧列表组件\r\nimport AnimationList from \"@/components/AnimationList\"; // 右侧动画列表\r\nimport EventList from \"@/components/EventList\"; // 右侧事件列表\r\nimport componentList from \"@/custom-component/component-list\"; // 左侧列表数据\r\nimport Toolbar from \"@/components/Toolbar\";\r\nimport { deepCopy } from \"@/utils/utils\";\r\nimport { mapState } from \"vuex\";\r\nimport generateID from \"@/utils/generateID\";\r\nimport { listenGlobalKeyDown } from \"@/utils/shortcutKey\";\r\nimport RealTimeComponentList from \"@/components/RealTimeComponentList\";\r\nimport CanvasAttr from \"@/components/CanvasAttr\";\r\nimport NavigationBar from \"@/components/NavigationBar\";\r\n\r\nexport default {\r\n  components: {\r\n    NavigationBar,\r\n    Editor,\r\n    ComponentList,\r\n    AnimationList,\r\n    EventList,\r\n    Toolbar,\r\n    RealTimeComponentList,\r\n    CanvasAttr,\r\n  },\r\n  data() {\r\n    return {\r\n      activeName: \"attr\",\r\n      reSelectAnimateIndex: undefined,\r\n      isOpenAFile: true,\r\n      designId: \"\",\r\n      designList: [],\r\n    };\r\n  },\r\n  computed: mapState([\r\n    \"componentData\",\r\n    \"curComponent\",\r\n    \"isClickComponent\",\r\n    \"canvasStyleData\",\r\n    \"editor\",\r\n  ]),\r\n  created() {\r\n    var arr = this.$route.params.id.split(\"&\");\r\n    this.projectId = arr[0];\r\n    this.getDesign();\r\n    if(arr.length > 2) {\r\n      this.isOpenAFile = true;\r\n      this.designId = arr[2];\r\n      this.getDesignDetail();\r\n    }\r\n    else this.isOpenAFile = false;\r\n\r\n    this.restore();\r\n    // 全局监听按键事件\r\n    listenGlobalKeyDown();\r\n  },\r\n  methods: {\r\n    openFile(id) {\r\n      this.$router.replace(\"/project/\" + this.projectId + \"&design&\" + id);\r\n      window.location.reload();\r\n    },\r\n    add() {\r\n      let formData = new FormData();\r\n      formData.append(\"title\", \"Unknown Document\");\r\n      formData.append(\"description\", \"文档描述\");\r\n      formData.append(\"content\", JSON.stringify(\"<p>this is a document</p>\"));\r\n      formData.append(\"projectId\", this.projectId);\r\n\r\n      var header = {};\r\n      if (localStorage.getItem(\"token\"))\r\n        header = { Authorization: \"Bearer \" + localStorage.getItem(\"token\") };\r\n\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"/api/v1/document/create/\" + this.projectId,\r\n        data: formData,\r\n        headers: header,\r\n      })\r\n      .then((res) => {\r\n        console.log(res.data);\r\n        this.openDoc(res.data.id);\r\n      })\r\n      .catch((err) =>{\r\n        console.log(err);\r\n      });\r\n    },\r\n\r\n    restore() {\r\n      // 用保存的数据恢复画布\r\n      if (localStorage.getItem(\"canvasData\")) {\r\n        this.$store.commit(\r\n          \"setComponentData\",\r\n          JSON.parse(localStorage.getItem(\"canvasData\"))\r\n        );\r\n      }\r\n\r\n      if (localStorage.getItem(\"canvasStyle\")) {\r\n        this.$store.commit(\r\n          \"setCanvasStyle\",\r\n          JSON.parse(localStorage.getItem(\"canvasStyle\"))\r\n        );\r\n      }\r\n    },\r\n\r\n    handleDrop(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      const index = e.dataTransfer.getData(\"index\");\r\n      const rectInfo = this.editor.getBoundingClientRect();\r\n      if (index) {\r\n        const component = deepCopy(componentList[index]);\r\n        component.style.top = e.clientY - rectInfo.y;\r\n        component.style.left = e.clientX - rectInfo.x;\r\n        component.id = generateID();\r\n        this.$store.commit(\"addComponent\", { component });\r\n        this.$store.commit(\"recordSnapshot\");\r\n      }\r\n    },\r\n\r\n    handleDragOver(e) {\r\n      e.preventDefault();\r\n      e.dataTransfer.dropEffect = \"copy\";\r\n    },\r\n\r\n    handleMouseDown(e) {\r\n      e.stopPropagation();\r\n      this.$store.commit(\"setClickComponentStatus\", false);\r\n      this.$store.commit(\"setInEditorStatus\", true);\r\n    },\r\n\r\n    deselectCurComponent(e) {\r\n      if (!this.isClickComponent) {\r\n        this.$store.commit(\"setCurComponent\", { component: null, index: null });\r\n      }\r\n\r\n      // 0 左击 1 滚轮 2 右击\r\n      if (e.button != 2) {\r\n        this.$store.commit(\"hideContextMenu\");\r\n      }\r\n    },\r\n    async getDesignDetail() {\r\n      var header = {};\r\n      if (localStorage.getItem(\"token\"))\r\n        header = { Authorization: \"Bearer \" + localStorage.getItem(\"token\") };\r\n\r\n      await this.$axios({\r\n        method: \"get\",\r\n        url: \"/api/v1/diagram/\" + this.designId,\r\n        headers: header,\r\n      })\r\n      .then((res) => {\r\n        console.log(res.data);\r\n        var r = res.data;\r\n        // this.documentContent = r.content;\r\n        // this.belongTo = r.belongTo;\r\n        // this.createdAt = r.createdAt;\r\n        // this.updatedAt = r.updatedAt;\r\n        // this.createdBy = r.createdBy;\r\n        // this.title = r.title;\r\n        // this.description = r.description;\r\n        // this.status = true;\r\n      })\r\n      .catch((err) =>{\r\n        console.log(err);\r\n      });\r\n    },\r\n    getDesign() {\r\n      var header = {};\r\n      if (localStorage.getItem(\"token\"))\r\n        header = { Authorization: \"Bearer \" + localStorage.getItem(\"token\") };\r\n\r\n      this.$axios({\r\n        method: \"get\",\r\n        url: \"/api/v1/diagram/list?belongTo=\" + this.projectId,\r\n        headers: header,\r\n      })\r\n      .then((res) => {\r\n        this.designList = res.data.results\r\n      })\r\n      .catch((err) =>{\r\n        console.log(err);\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.design {\r\n  height: 100vh;\r\n  background: #fff;\r\n\r\n  main {\r\n    height: calc(100% - 64px);\r\n    position: relative;\r\n\r\n    .left {\r\n      //margin-left: 130px;\r\n      position: absolute;\r\n      height: 100%;\r\n      width: 200px;\r\n      left: 10px;\r\n      top: 70px;\r\n\r\n      & > div {\r\n        overflow: auto;\r\n\r\n        &:first-child {\r\n          border-bottom: 1px solid #ddd;\r\n        }\r\n      }\r\n    }\r\n\r\n    .right {\r\n      position: absolute;\r\n      height: 100%;\r\n      width: 288px;\r\n      right: 0;\r\n      top: 70px;\r\n\r\n      .el-select {\r\n        width: 100%;\r\n      }\r\n    }\r\n\r\n    .center {\r\n      margin-left: 330px;\r\n      margin-right: 288px;\r\n      background: #f5f5f5;\r\n      height: 100%;\r\n      overflow: auto;\r\n      padding: 20px;\r\n\r\n      .content {\r\n        width: 100%;\r\n        height: 100%;\r\n        overflow: auto;\r\n      }\r\n    }\r\n  }\r\n\r\n  .placeholder {\r\n    text-align: center;\r\n    color: #333;\r\n  }\r\n\r\n  .global-attr {\r\n    padding: 10px;\r\n  }\r\n}\r\n.add-icon:hover, .design-content li:hover {\r\n  cursor: pointer;\r\n}\r\n.add-icon {\r\n  display: inline-block;\r\n  color: darkgray;\r\n  margin-left: 20px;\r\n}\r\n.design-content li {\r\n  margin: 5px 0;\r\n}\r\n.content-title {\r\n  margin: 10px 0;\r\n}\r\n.design-content {\r\n  padding: 10px 20px;\r\n  // background-color: beige;\r\n  border-right: 2px lightgray solid;\r\n  height: 100vh;\r\n}\r\n.project-name {\r\n  font-weight: 600;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Design.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Design.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Design.vue?vue&type=template&id=05f2c0b6&\"\nimport script from \"./Design.vue?vue&type=script&lang=js&\"\nexport * from \"./Design.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Design.vue?vue&type=style&index=0&id=05f2c0b6&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","staticClass","_v","_s","projectName","on","add","_l","designList","item","key","id","$event","openFile","title","isOpenAFile","handleDrop","handleDragOver","handleMouseDown","deselectCurComponent","curComponent","model","value","activeName","callback","$$v","expression","component","tag","staticStyle","_e","staticRenderFns","components","NavigationBar","Editor","ComponentList","AnimationList","EventList","Toolbar","RealTimeComponentList","CanvasAttr","data","reSelectAnimateIndex","designId","computed","created","listenGlobalKeyDown","methods","window","formData","header","Authorization","method","url","headers","then","res","console","catch","err","restore","JSON","e","index","getDesign"],"sourceRoot":""}