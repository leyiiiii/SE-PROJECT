"use strict";(self["webpackChunkMoShu"]=self["webpackChunkMoShu"]||[]).push([[940],{29856:function(e,t,a){a.d(t,{Z:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("el-row",[t("el-container",[t("el-aside",{attrs:{width:"auto"},nativeOn:{mouseenter:function(t){return e.collapseOpen.apply(null,arguments)},mouseleave:function(t){return e.collapseClose.apply(null,arguments)}}},[t("el-menu",{staticClass:"nav-menu",attrs:{router:!0,"unique-opened":!0,collapse:e.isCollapse},on:{open:e.handleOpen,close:e.handleClose}},[t("el-submenu",{attrs:{index:"1"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-user"}),t("span",[e._v(" 用户管理 ")])]),t("el-menu-item-group",[t("el-menu-item",{staticStyle:{cursor:"default"},attrs:{index:""}},[e.profilePic?t("el-avatar",{attrs:{size:25,src:e.profilePic}}):t("el-avatar",{attrs:{size:25,icon:"el-icon-user"}}),t("span",[e._v(" "+e._s(e.username)+" ")])],1),t("el-menu-item",{attrs:{index:""}},[t("i",{staticClass:"el-icon-camera"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" 更改头像 ")]),t("input",{attrs:{id:"imgUpload",type:"file",accept:"image/png,image/gif,image/jpeg"},on:{change:function(t){return e.uploadAvatar(t)}}})]),t("el-menu-item",{attrs:{index:""},on:{click:function(t){e.dialogFormVisible1=!0}}},[t("i",{staticClass:"el-icon-edit"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" 编辑资料 ")])]),t("el-menu-item",{attrs:{index:"/"},on:{click:e.Logout}},[t("i",{staticClass:"el-icon-switch-button"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" 退出登录 ")])])],1)],2),t("el-submenu",{attrs:{index:"2"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-office-building"}),t("span",[e._v(" 团队 ")])]),t("el-menu-item-group",[t("el-menu-item",{staticStyle:{"font-size":"16px",color:"darkslateblue"},attrs:{index:""},on:{click:function(t){e.dialogFormVisible2=!0}}},[e._v(" 创建团队 "),t("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"16px",color:"darkslateblue"}})]),e._l(e.joinedTeam,(function(a){return t("el-menu-item",{key:a.index,on:{click:function(t){return e.toTeam(a.id)}}},[e._v(e._s(a.teamName)+" ")])}))],2)],2),t("el-menu-item",{attrs:{index:"/invitation"}},[t("i",{staticClass:"el-icon-postcard"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" 查看邀请 ")])]),t("el-menu-item",{attrs:{index:"/about"}},[t("i",{staticClass:"el-icon-collection"}),t("span",{staticClass:"mainTitle"},[e._v(" 关于墨书 ")])])],1)],1),t("el-main")],1),t("el-dialog",{attrs:{title:"编辑个人信息",visible:e.dialogFormVisible1,"append-to-body":"true"},on:{"update:visible":function(t){e.dialogFormVisible1=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"昵称","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"真实姓名","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.realname,callback:function(t){e.$set(e.form,"realname",t)},expression:"form.realname"}})],1),t("el-form-item",{attrs:{label:"邮箱","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{label:"个性签名","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.about,callback:function(t){e.$set(e.form,"about",t)},expression:"form.about"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelEdit}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.editProfile}},[e._v(" 确 定 ")])],1)],1),t("el-dialog",{attrs:{title:"创建团队",visible:e.dialogFormVisible2,"append-to-body":"true"},on:{"update:visible":function(t){e.dialogFormVisible2=t}}},[t("el-form",{attrs:{model:e.team}},[t("el-form-item",{attrs:{label:"团队名称","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.team.name,callback:function(t){e.$set(e.team,"name",t)},expression:"team.name"}})],1),t("el-form-item",{attrs:{label:"简介","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.team.desc,callback:function(t){e.$set(e.team,"desc",t)},expression:"team.desc"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelEdit2}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.createTeam}},[e._v(" 确 定 ")])],1)],1)],1)},i=[],o=a(92094),l={data(){return{isLogin:!1,joinedTeam:[],collapseBtnClick:!1,isCollapse:!0,userId:"",username:"",profilePic:"",form:{username:"",profilePic:"",realname:"",email:"",about:""},team:{name:"",desc:""},dialogFormVisible1:!1,dialogFormVisible2:!1,formLabelWidth:"120px"}},created(){var e;e=o.Z.getters.getUser(o.Z.state()),e&&(this.isLogin=!0,this.$store.state._isLogin_=!0,this.userId=e.user.id,this.username=e.user.username,this.form.username=e.user.username,this.getUser())},mounted(){this.getJoinedTeam()},methods:{createTeam(){if(""==this.team.name)return void this.$message.warning("团队名不可为空");if(""==this.team.desc)return void this.$message.warning("团队简介不可为空");const e=new FormData;e.append("teamName",this.team.name),e.append("description",this.team.desc);var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"post",url:"/api/v1/team/create",data:e,headers:t}).then((e=>{console.log(e),this.$message.success("创建成功"),this.dialogFormVisible2=!1,this.team.name="",this.team.desc=""})).catch((e=>{console.log(e)}))},getImg(e){this.form.profilePic=e.target.files[0]},async uploadAvatar(e){this.form.profilePic=e.target.files[0];const t=new FormData;t.append("email",this.form.email),t.append("username",this.form.username),t.append("userId",this.form.id),t.append("about",this.form.about),t.append("realname",this.form.realname),t.append("profile",this.form.profilePic);var a={};localStorage.getItem("token")&&(a={Authorization:"Bearer "+localStorage.getItem("token")}),await this.$axios({method:"put",url:"/api/v1/auth/detail/"+this.userId,data:t,headers:a}).then((e=>{console.log(e),this.getUser(),setTimeout((function(){location.reload(!0)}),500),this.$message.success("恭喜！修改成功")})).catch((e=>{console.log(e),this.$message.warning("抱歉！上传失败")}))},async editProfile(){const e=new FormData;e.append("email",this.form.email),e.append("username",this.form.username),e.append("userId",this.form.id),e.append("about",this.form.about),e.append("realname",this.form.realname);var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),await this.$axios({method:"put",url:"/api/v1/auth/detail/"+this.userId,data:e,headers:t}).then((e=>{console.log(e),this.getUser(),this.dialogFormVisible1=!1,setTimeout((function(){location.reload(!0)}),500),this.$message.success("恭喜！修改成功")})).catch((e=>{console.log(e),this.$message.warning("抱歉！昵称已被使用")}))},cancelEdit2(){this.dialogFormVisible2=!1,this.getUser()},cancelEdit(){this.dialogFormVisible1=!1,this.getUser()},collapseStatus(){this.collapseBtnClick=this.isCollapse,this.isCollapse=!this.isCollapse},collapseOpen(){this.collapseBtnClick||(this.isCollapse=!1)},collapseClose(){this.collapseBtnClick||(this.isCollapse=!0)},handleOpen(e,t){console.log(e,t)},handleClose(e,t){console.log(e,t)},Logout(){localStorage.removeItem("token"),this.$store.dispatch("clear"),this.$message.success("登出成功"),setTimeout((()=>{this.$router.push({path:"/"}),location.reload()}),500)},async getUser(){var e={};localStorage.getItem("token")&&(e={Authorization:"Bearer "+localStorage.getItem("token")}),await this.$axios({method:"get",url:"/api/v1/auth/detail/"+this.userId,headers:e}).then((e=>{console.log(e),this.form.realname=e.data.realname,this.form.email=e.data.email,this.profilePic=e.data.thumbnail,this.form.profilePic=e.data.thumbnail})).catch((e=>{console.log(e)}))},async getJoinedTeam(){var e={};localStorage.getItem("token")&&(e={Authorization:"Bearer "+localStorage.getItem("token")}),await this.$axios({method:"get",url:"/api/v1/team/list",headers:e}).then((e=>{console.log(e),this.joinedTeam=e.data.results})).catch((e=>{console.log(e)}))},toTeam(e){this.$router.push("/team/"+e),setTimeout((()=>{location.reload()}),500)},toInvitation(){this.isLogin?this.$router.push("/invitation"):this.$notify({title:"注意！",message:"请先进行登录",type:"warning"})}}},r=l,n=a(1001),c=(0,n.Z)(r,s,i,!1,null,"1efd312a",null),m=c.exports},59940:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("el-row",[t("el-col",{attrs:{span:2}},[t("div",{staticClass:"Left"},[t("Navi")],1)]),t("el-col",{attrs:{span:22}},[t("div",{staticClass:"Right"},[t("el-row",[t("el-col",{attrs:{span:3}},[t("div",{staticClass:"Title"},[t("span",[e._v("回收站")])])]),t("el-col",{attrs:{span:12}},[t("div",{staticClass:"deleteAll"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"清空回收站",placement:"bottom-start"}},[t("el-button",{staticClass:"deleteAllButton",attrs:{type:"danger",round:"",icon:"el-icon-delete"},on:{click:function(t){e.dialogVisible=!0}}})],1),t("el-dialog",{attrs:{title:"清空回收站",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("span",{staticClass:"line1"},[e._v("确定清空回收站？")]),t("span",{staticClass:"line2"},[e._v("注意：确定此操作后所有项目、文档、设计原型等将无法恢复")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.deleteAll}},[e._v("确定")])],1)]),t("el-button",{staticClass:"returnButton",attrs:{type:"info",icon:"el-icon-back",round:"",plain:""},on:{click:e.toTeam}},[e._v("返回团队")])],1)])],1),e.isEmpty?t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"noRecycle"},[t("img",{staticClass:"noRecycleImg",attrs:{src:a(72489)}}),t("p",[e._v("此时回收站为空，您删除的东西都会出现在这里哟~")])])])],1):e._e(),t("el-row",{staticClass:"cardsRow",attrs:{v:"",else:""}},e._l(e.recoveryList,(function(s){return t("el-col",{key:s.id,attrs:{span:7}},[t("div",{staticClass:"recoveryCard"},[t("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},["项目"==s.type?t("img",{staticClass:"image",attrs:{src:a(3783)}}):e._e(),"设计原型"==s.type?t("img",{staticClass:"image",attrs:{src:a(96525)}}):e._e(),"文件夹"==s.type?t("img",{staticClass:"image",attrs:{src:a(80494)}}):e._e(),"文档"==s.type?t("img",{staticClass:"image",attrs:{src:a(43112)}}):e._e(),t("div",{staticStyle:{padding:"14px"}},[t("span",[e._v(e._s(s.title))]),t("div",{staticClass:"bottom clearfix"},[t("time",{staticClass:"type"},[e._v(e._s(s.type))]),t("el-button",{staticClass:"button1",attrs:{type:"danger"},on:{click:function(t){return e.Delete(s.id)}}},[e._v("永久删除")]),t("el-button",{staticClass:"button2",attrs:{type:"success"},on:{click:function(t){return e.Recover(s.id)}}},[e._v("还原")])],1)])])],1)])})),1)],1)])],1)},i=[],o=a(29856),l={name:"Recycle",components:{Navi:o.Z},mounted(){this.getRecoveryList()},data(){return{dialogVisible:!1,recoveryList:[],isEmpty:!1}},methods:{getRecoveryList(){var e={};localStorage.getItem("token")&&(e={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"get",url:"/api/v1/recovery/list/"+this.$route.params.id,headers:e}).then((e=>{console.log(e),this.recoveryList=e.data.results,0==this.recoveryList.length&&(this.isEmpty=!0);for(let t=0;t<this.recoveryList.length;t++)0==this.recoveryList[t].type&&(this.recoveryList[t].type="项目"),1==this.recoveryList[t].type&&(this.recoveryList[t].type="文档"),2==this.recoveryList[t].type&&(this.recoveryList[t].type="设计原型"),3==this.recoveryList[t].type&&(this.recoveryList[t].type="文件夹")})).catch((e=>{console.log(e)}))},Recover(e){var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"put",url:"/api/v1/recovery/"+e,headers:t}).then((e=>{console.log(e),this.$message.success("恢复成功！"),setTimeout((function(){location.reload(!0)}),500)})).catch((e=>{console.log(e)}))},Delete(e){var t={};localStorage.getItem("token")&&(t={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"delete",url:"/api/v1/recovery/"+e,headers:t}).then((e=>{console.log(e),this.$message.success("删除成功！"),setTimeout((function(){location.reload(!0)}),500)})).catch((e=>{console.log(e)}))},deleteAll(){var e={};localStorage.getItem("token")&&(e={Authorization:"Bearer "+localStorage.getItem("token")}),this.$axios({method:"delete",url:"/api/v1/recovery/clear/"+this.$route.params.id,headers:e}).then((e=>{console.log(e),this.$message.success("清空成功！"),this.dialogVisible=!1,setTimeout((function(){location.reload(!0)}),500)})).catch((e=>{console.log(e),this.$message.info("回收站已清空"),this.dialogVisible=!1}))},toTeam(){this.$router.push("/team/"+this.$route.params.id)}}},r=l,n=a(1001),c=(0,n.Z)(r,s,i,!1,null,"1094e1c2",null),m=c.exports},3783:function(e,t,a){e.exports=a.p+"img/Recycle1.bcf52827.png"},96525:function(e,t,a){e.exports=a.p+"img/Recycle2.5fc5a6d1.png"},80494:function(e,t,a){e.exports=a.p+"img/Recycle3.ea7cacf0.png"},43112:function(e,t,a){e.exports=a.p+"img/Recycle4.8d9765e9.png"},72489:function(e,t,a){e.exports=a.p+"img/Recycle5.18124446.png"}}]);
//# sourceMappingURL=940.c05d9d1e.js.map